# NGS-analysis-for-Somatic-Mutation-calling
This is a Pipeline for Somatic mutation calling using Panel of normals to exclude germline variants
```markdown
# Somatic NGS Pipeline (Tumor–Normal, PoN, Mutect2)

A reproducible Snakemake workflow to call somatic variants from NGS data using:
Trimmomatic → FastQC → BWA-MEM → Picard/Samtools/Sambamba → GATK Mutect2 + FilterMutectCalls → VCF QC.

## Key Features
- Tumor–normal calling with **Panel of Normals (PoN)** and **germline resource**.
- Low‑VAF sensitivity oriented (e.g., reliable at ~5% VAF with high depth).
- Modular rules and single `config.yaml`.
- Conda environment for full reproducibility.
- CI (GitHub Actions) dry‑runs to validate PRs.

## Repository Structure
See the tree in the project root for directories and files.

## Requirements
- Linux/macOS
- Conda (mamba recommended)
- Snakemake ≥7

## Input Sheets
- `config/samples.tsv` — sample metadata (one row per sample).
- `config/pairs.tsv` — mapping of tumor ↔ normal samples.

## Reference & Resources
Place under `resources/reference/`:
- `wg.fa` (hg38 FASTA)
- Indexes: `wg.fa.fai`, BWA index `hg38bwaidx.*`, GATK dict `wg.dict`
- Germline resource: `somatic-hg38_af-only-gnomad.hg38.vcf.gz` (+ `.tbi`)
- **Optional PoN**: `somatic-hg38_1000g_pon.hg38.vcf.gz` (+ `.tbi`) or a custom PoN generated by the workflow.

## Usage
```bash
snakemake --use-conda --cores 16 -p
```

## Outputs (default)
- QC: `results/qc/fastqc/*.html`
- Trimmed FASTQs: `results/trimmed/{sample}/*.trim.fastq.gz`
- Deduped BAMs: `results/bam/{sample}/{sample}.final_sorted_deduped.bam`
- Mutect2 VCF (tumor–normal): `results/mutect2/{pair}.somatic.vcf.gz`
- Filtered VCF: `results/mutect2/{pair}.somatic.filtered.vcf.gz`
- Optional PoN: `results/pon/bladder_pon.vcf.gz`

## Citation / Acknowledgements
- Trimmomatic, FastQC, BWA, Picard, Samtools, Sambamba, GATK, bcftools, vcftools.
- Built by Raiyan Hosen (University of Dhaka).

## License
MIT (see `LICENSE`).

```
